<%- include('partials/header') %>

<main>
  <section class="discussion-container">
    <div class="discussion-header">
      <h1>Discussions ðŸ”¥</h1>
      <p>Welcome! You can start a discussion or join one. <br>It's anonumous and also, every discussion clears after a week, so it's totally safe</p>
    </div>

    <div class="discussion-list">
      <% discussions.forEach(discussion => { %>
      <details class="discussion-item">
        <summary class="discussion-title"><%= discussion.title %></summary>
        <div class="messages">
          <% discussion.messages.forEach(message => { %>
          <p class="message"><%= message %></p>
          <% }) %>
        </div>
        <form class="reply-form" data-id="<%= discussion.id %>">
          <textarea placeholder="Write a reply..." required></textarea>
          <button type="submit" class="btn-reply">Reply</button>
        </form>
      </details>
      <% }) %>
    </div>

    <section id="start-discussion">
      <h3>Start a Discussion</h3>
      <form id="start-discussion-form">
        <input
          type="text"
          name="title"
          placeholder="Discussion title"
          required
        />
        <textarea
          name="message"
          placeholder="Your first message..."
          required
        ></textarea>
        <button type="submit" class="btn-start">Start Discussion</button>
      </form>
    </section>
  </section>
</main>

<script src="/discussions.js"></script>
<%- include('partials/footer') %>
